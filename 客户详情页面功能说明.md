# 客户详情页面功能说明

## 功能概览

当用户点击客户列表中的公司名称时，系统会打开详细的客户详情页面，展示以下信息和功能：

## 1. 显示公司名称
- 在页面顶部显著位置显示用户的公司名称
- 如果未提供公司名称，显示"未提供"
- 公司名称在客户列表中可点击跳转到详情页

## 2. 显示电话号码
- 显示用户注册或维护的电话号码
- 支持点击复制功能（使用CopyButton组件）
- 支持点击拨打电话功能
- 电话号码旁边有复制和拨打按钮

## 3. 分配的销售代表
- 显示当前分配给该用户的销售代表
- 点击销售代表姓名可以链接到销售代表的客户列表（待实现）
- 管理员可以手动更改分配的销售代表
- 提供销售代表选择器，支持从下拉列表中选择或取消分配

## 4. 最后登录时间 + IP地址
- 显示用户最近一次登录时间和IP地址
- 如果用户从未登录，显示"从未登录"
- IP地址支持点击复制功能
- 显示设备信息和用户代理信息

## 5. 运单状态统计
- 显示该用户运单的状态统计，包括：
  - 待付款（已下单）
  - 已提交（已收货）
  - 运输中（转运中）
  - 已送达（已签收）
  - 异常（退件）
- 每个状态显示对应的运单数量
- 每个状态卡片可点击链接到过滤后的运单列表
- 只包含该用户创建的运单（不包含子账户）

## 6. 当前账户余额
- 显示用户当前可用余额，精确到小数点后两位
- 负值表示透支或逾期结算
- 使用颜色区分正负余额（绿色为正，红色为负）
- 显示在财务信息标签页中

## 7. 逾期金额
- 显示超过约定信用期的逾期总金额
- 如果无逾期余额，显示"¥0.00"
- 从计费系统中计算未付逾期账单
- 使用颜色提示（红色为有逾期，绿色为无逾期）

## 8. 月度运单趋势图表
- 显示过去60天的每日运单量折线图
- X轴：日期
- Y轴：运单数量
- 使用不同颜色区分本月和上月数据
- 鼠标悬停显示具体日期和运单数量
- 图表顶部显示本月和上月的总运单数

## 页面结构

### 标签页组织
1. **概览** - 基本信息、销售代表、最后登录、运单统计、趋势图表
2. **运单记录** - 详细的运单列表和统计
3. **财务信息** - 账户余额、逾期金额、财务联系人
4. **登录日志** - 最近5次登录记录详情

### 交互功能
- 电话号码和IP地址支持一键复制
- 电话号码支持点击拨打
- 销售代表支持在线编辑和分配
- 运单状态卡片支持点击查看详情
- 登录日志支持查看详细信息

## 技术实现

### 前端组件
- `app/clients/[id]/page.tsx` - 主要详情页面
- `components/ui/CopyButton.tsx` - 复制按钮组件
- `components/charts/ShipmentTrendChart.tsx` - 趋势图表组件
- `components/clients/SalesRepSelector.tsx` - 销售代表选择器

### API接口
- `GET /api/clients/[id]` - 获取客户详细信息
- `PUT /api/clients/[id]` - 更新客户信息（包括销售代表）
- `GET /api/clients/[id]/shipments` - 获取客户运单数据
- `GET /api/sales-reps` - 获取销售代表列表

### 数据库字段
- 客户基本信息（Customer表）
- 销售代表关联（financeContact字段）
- 登录日志（LoginLog表）
- 运单数据（FBAOrder表）

## 使用方法

1. 在客户列表页面点击任意公司名称
2. 系统自动跳转到客户详情页面
3. 在不同标签页之间切换查看不同信息
4. 使用复制按钮复制电话号码或IP地址
5. 点击编辑按钮修改销售代表分配
6. 查看趋势图表了解运单变化趋势

## 注意事项

- 所有金额显示精确到小数点后两位
- 日期时间使用中文本地化格式
- 图表数据实时更新
- 支持响应式设计，适配不同屏幕尺寸
- 错误处理和加载状态提示 